Sub AR_Variance()
    Dim wsCurrent As Worksheet
    Dim wsPrior As Worksheet
    Dim todayDate As Date
    Dim fiscalStartMonth As Integer
    Dim fiscalPeriod As Integer
    Dim priorFiscalPeriod As Integer
    Dim adjustedDate As Date
    Dim currentDay As Integer
    
    ' Define FRCC's FY Start Month
    fiscalStartMonth = 7
    
    ' Use the current date for calculations
    todayDate = Date ' Default: current system date
    
    ' Get the current day of the month
    currentDay = Day(todayDate)
    
    ' Adjust the date for fiscal period calculation
    If currentDay <= 14 Then
        ' If today is between the 1st and 14th, consider the previous month
        If Month(todayDate) = 1 Then
            ' Handle January edge case
            adjustedDate = DateSerial(Year(todayDate) - 1, 12, 1)
        Else
            adjustedDate = DateSerial(Year(todayDate), Month(todayDate) - 1, 1)
        End If
    Else
        ' Otherwise, use the current month
        adjustedDate = DateSerial(Year(todayDate), Month(todayDate), 1)
    End If
    
    ' Calculate the Current Fiscal Period
    If Month(adjustedDate) >= fiscalStartMonth Then
        fiscalPeriod = ((Month(adjustedDate) - fiscalStartMonth + 12) Mod 12) + 1
    Else
        fiscalPeriod = ((Month(adjustedDate) - fiscalStartMonth + 12 + 12) Mod 12) + 1
    End If
    
    ' Determine the Prior Fiscal Period
    priorFiscalPeriod = fiscalPeriod - 1
    If priorFiscalPeriod = 0 Then
        priorFiscalPeriod = 12
    End If
    
    ' Find sheets "Current Period" and "Prior Period" for renaming purposes
    On Error Resume Next
    Set wsCurrent = Worksheets("Current Period")
    Set wsPrior = Worksheets("Prior Period")
    On Error GoTo 0
    
    ' Validate sheets exist before renaming
    If wsCurrent Is Nothing Or wsPrior Is Nothing Then
        MsgBox "One or both sheets ('Current Period', 'Prior Period') are missing.", vbExclamation
        Exit Sub
    End If
    
    ' Rename sheets
    wsCurrent.Name = "Period " & fiscalPeriod
    wsPrior.Name = "Period " & priorFiscalPeriod

End Sub
